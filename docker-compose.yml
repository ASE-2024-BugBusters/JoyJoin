version: "1"
services:
  postgres-user:
    container_name: postgres-user
    image: postgres
    environment:
        POSTGRES_DB: user-service
        POSTGRES_USER: postgres
        POSTGRES_PASSWORD: 1234
        PGDATA: /data/postgres
    volumes:
      - ./postgres-user:/data/postgres
    expose:
      - "5431"
    ports:
      - "5431:5431"
    command: -p 5431
    restart: unless-stopped

  registry-service:
    image: josip97/registry-service:latest
    container_name: registry-service
    pull_policy: always
    ports:
      - "8761:8761"

  api-gateway:
    image: josip97/api-gateway:latest
    container_name: api-gateway
    pull_policy: always
    ports:
      - "9191:9191"
    expose:
      - "9191"
    depends_on:
      registry-service:
        condition: service_started


  user-service:
    image: josip97/user-service:latest
    container_name: user-service
    pull_policy: always
    ports:
      - "8085:8085"
    expose:
      - "8085"
    depends_on:
      postgres-user:
        condition: service_started
      registry-service:
        condition: service_started
      api-gateway:
        condition: service_started

